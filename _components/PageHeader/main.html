{% assign slashed_category = '/' | append: page.category | append: '/' %}
{% if page.url == slashed_category %}
  {% assign selected_tag = 'h1' %}
{% else %}
  {% assign selected_tag = 'a' %}
{% endif %}

{% capture focus_indicator %}
{% assign padding = 15 %}
{% assign edgelen = 15 %}
{% assign canvas_size = 100 %}
{% assign stroke_width = 3 %}
  <svg viewBox="0 0 100 100" preserveAspectRatio="xMinYMin" style="overflow: visible">
    <path
        d="M {{ padding }},{{ padding | plus: edgelen }} v -{{ edgelen }} h {{ edgelen }}"
        fill="none"
        stroke-width="{{ stroke_width }}"
        stroke="white" />
  </svg>
  <svg viewBox="0 0 100 100" preserveAspectRatio="xMaxYMin" style="overflow: visible">
    <path
        d="M {{ canvas_size | minus: padding }},{{ padding | plus: edgelen }} v -{{ edgelen }} h -{{ edgelen }}"
        fill="none"
        stroke-width="{{ stroke_width }}"
        stroke="white" />
  </svg>
  <svg viewBox="0 0 100 100" preserveAspectRatio="xMaxYMax" style="overflow: visible">
    <path
        d="M {{ canvas_size | minus: padding }},{{ canvas_size | minus: padding | minus: edgelen }} v {{ edgelen }} h -{{ edgelen }}"
        fill="none"
        stroke-width="{{ stroke_width }}"
        stroke="white" />
  </svg>
  <svg viewBox="0 0 100 100" preserveAspectRatio="xMinYMax" style="overflow: visible">
    <path
        d="M {{ padding }},{{ canvas_size | minus: padding | minus: edgelen }} v {{ edgelen }} h {{ edgelen }}"
        fill="none"
        stroke-width="{{ stroke_width }}"
        stroke="white" />
  </svg>
{% endcapture %}

<header class="PageHeader">
  <div class="PageHeader-InnerBounds">
    <a href="/" class="PageHeader-Logo" title="Go to start page">
      {% block root-LogoChristopherAue %}
    </a>
    <nav class="PageHeader-CategoryDropdown">
      {%- container_with_dynamically_scoped_body CategoryDropdown
          entries=site.category_list
          selected=page.category
          selected_tag=selected_tag
          focus_indicator=focus_indicator -%}
        <div class="PageHeader-CategoryDropdown-ItemContent">
          {% block root-Slash{{ param.entry | capitalize }} %}
        </div><!--
     --><div class="PageHeader-CategoryDropdown-ItemArrow"></div>
      {%- endcontainer_with_dynamically_scoped_body -%}
    </nav>
  </div>
</header>

<script>
    // requirejs delays loading our synchronous javascript (the _sync.js file)
    // until the next event loop tick. To prevent the site from flickering
    // before the transition is started, the initial state of the page
    // transition must be set up immediately.
    !function() {
        var transitionJSON = window.sessionStorage.getItem('pageTransition');
        if (transitionJSON) {
            var transition = JSON.parse(transitionJSON),
                header = document.querySelector('.PageHeader');

            if (transition.transitionHeader) {
                header.style.opacity = 0;
            }
        }
    }();
</script>